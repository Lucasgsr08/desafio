<mvc:View
    controllerName="com.todoapp.controller.Home"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core">
    
    <Page 
        title="{i18n>appTitle}"
        showHeader="true"
        enableScrolling="true"
        backgroundDesign="Solid">

        <!-- Barra de Busca -->
        <subHeader>
            <Toolbar>
                <SearchField
                    width="100%"
                    placeholder="{i18n>search}..."
                    search=".onSearch"
                    liveChange=".onLiveSearch"
                    showSearchButton="true"
                    value="{todoModel>/search}"/>
            </Toolbar>
        </subHeader>
        
        <!-- Conteúdo Principal -->
        <content>
            <VBox class="sapUiSmallMargin">
                
                <!-- Indicador de Carregamento -->
                <BusyIndicator
                    id="busyIndicator"
                    text="{i18n>loading}"
                    class="sapUiSmallMarginBottom"
                    visible="{todoModel>/busy}"/>
                
                <!-- Mensagem Informativa -->
                <MessageStrip
                    text="Total: {todoModel>/totalCount} | {i18n>lblPage} {todoModel>/page} {i18n>lblOf} {todoModel>/totalPages}"
                    type="Information"
                    showIcon="true"
                    visible="{= ${todoModel>/totalCount} > 0 }"/>
                
                <!-- Lista de Todos -->
                <List
                    id="todoList"
                    items="{todoModel>/items}"
                    mode="SingleSelectMaster"
                    selectionChange=".onSelectionChange"
                    noDataText="{i18n>msgNoTodos}">
                    
                    <!-- Header da Lista -->
                    <headerToolbar>
                        <OverflowToolbar>
                            <Title text="Tarefas" level="H2"/>
                            <ToolbarSpacer/>
                            <Button 
                                icon="sap-icon://sort"
                                text="{i18n>sort}"
                                type="Transparent"
                                press=".onSort"/>
                            <Button
                                icon="sap-icon://accept"
                                text="Alternar status"
                                type="Transparent"
                                press=".onToggleSelectedStatus"/>
                            <Button
                                icon="sap-icon://add"
                                text="Adicionar"
                                type="Emphasized"
                                press=".onAddTodo"/>
                            <Button
                                icon="sap-icon://delete"
                                text="Remover"
                                type="Reject"
                                press=".onRemoveTodo"/>
                        </OverflowToolbar>
                    </headerToolbar>
                    
                    <!-- Template para cada Item -->
                    <items>
                        <CustomListItem type="Active">
                            <HBox alignItems="Center" class="sapUiSmallMargin">
                                <!-- Checkbox de Status -->
                                <CheckBox
                                    selected="{todoModel>completed}"
                                    select=".onToggleComplete"
                                    enabled="true"
                                    tooltip="{i18n>lblCompleted}"/>
                                
                                <!-- Informações do Todo -->
                                <VBox class="sapUiSmallMarginBegin" width="100%">
                                    <ObjectIdentifier
                                        title="{todoModel>title}"
                                        titleActive="true"
                                        titlePress=".onViewDetails"/>
                                    <HBox>
                                        <Label text="{i18n>lblUserId}:" design="Bold" class="sapUiTinyMarginEnd"/>
                                        <Text text="{todoModel>userId}"/>
                                        <Label text="ID:" design="Bold" class="sapUiTinyMarginBegin"/>
                                        <Text text="{todoModel>id}"/>
                                    </HBox>
                                </VBox>
                                
                                <!-- Botão de Detalhes -->
                                <Button
                                    icon="sap-icon://display"
                                    type="Transparent"
                                    tooltip="{i18n>details}"
                                    press=".onViewDetails"/>
                            </HBox>
                        </CustomListItem>
                    </items>
                </List>
                
                <!-- Controles de Paginação -->
                <Toolbar class="sapUiSmallMarginTop">
                    <ToolbarSpacer/>
                    
                    <!-- Botão Página Anterior -->
                    <Button
                        icon="sap-icon://slim-arrow-left"
                        enabled="{= ${todoModel>/page} > 1 }"
                        tooltip="Página anterior"
                        press=".onPreviousPage"/>
                    
                    <!-- Informação de Página -->
                      <Text text="{i18n>lblPage} {todoModel>/page} {i18n>lblOf} {todoModel>/totalPages}" 
                          class="sapUiTinyMarginBegin"/>
                    
                    <!-- Botão Próxima Página -->
                    <Button
                        icon="sap-icon://slim-arrow-right"
                        enabled="{= ${todoModel>/page} &lt; ${todoModel>/totalPages} }"
                        tooltip="Próxima página"
                        press=".onNextPage"/>
                    
                    <!-- Seletor de Itens por Página -->
                    <Label text="{i18n>lblItemsPerPage}" class="sapUiTinyMarginBegin"/>
                    <Select
                        selectedKey="{todoModel>/pageSize}"
                        change=".onPageSizeChange"
                        width="80px">
                        <core:Item key="5" text="5"/>
                        <core:Item key="10" text="10"/>
                        <core:Item key="20" text="20"/>
                        <core:Item key="50" text="50"/>
                    </Select>
                </Toolbar>
            </VBox>
        </content>
        
        <!-- Rodapé -->
        <footer>
            <Toolbar>
                <ToolbarSpacer/>
                <Text text="API Backend: http://localhost:5001" class="sapUiTinyMarginEnd"/>
                <Text text="Versão SAPUI5: 1.108.0"/>
                <ToolbarSpacer/>
            </Toolbar>
        </footer>
    </Page>
</mvc:View>